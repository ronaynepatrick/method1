<%= render partial: 'header/head', locals: {user: current_user} %>
<% current_count=0 %>

<% $i=0 %>

<h1><%= @page.title %> </h1>
<% if @content.to_a.count == 0 %>
	<%= form_tag :new_passage do %>
		<%= hidden_field_tag :move_to, $i  %>
		<%= hidden_field_tag :current_position, 0 %>

		<%= submit_tag("Add Passage") %>
	<% end %>
<% end %>

<% while $i < @content.to_a.count do%>
	<% next_spot = $i+1 %>

	<% @content.to_a.each do |c| %>

		<% if c.position == $i %>
			


<!-- -----------------------------                  if is a passage                   ----------------------------------------- -->
			<% if c.class.name == "Passage" %>
				<% if c.linebreak %>
					<HR SIZE="2">
				<% end %>
				<%= c.passage.html_safe %>
				
				<div class="row">
					<div class="large-2 columns">
						<%= form_tag :edit_passage do %>
							<%= hidden_field_tag :p_id, c.id %>
							<%= submit_tag("Edit") %>
						<% end %>
					</div>

					<div class="large-2 columns">
						<%= form_tag :delete_passage do %>
							<%= hidden_field_tag :p_id, c.id %>
							<%= submit_tag("Remove") %>
						<% end %>
					</div>

					<div class="large-2 columns">
						<% if $i != 0 %>
							<%= form_tag :move_up do %>
								<%= hidden_field_tag :current_position, c.position %>
								<%= hidden_field_tag :move_to, c.position-1 %>
								<%= submit_tag("  ^  ") %>
							<% end %>
						<% end %>
					</div>

					<div class="large-2 columns">
						<% if $i != @content.to_a.count-1 %>
							<%= form_tag :move_down do %>
								<%= hidden_field_tag :current_position, c.position %>
								<%= hidden_field_tag :move_to, c.position+1 %>
								<%= submit_tag("  v  ") %>
							<% end %>
						<% end %>
					</div>
					
					<div class="large-2 columns">
						<%= form_tag :new_passage do %>
							<%= hidden_field_tag :current_position, @content.to_a.count %>
							<%= hidden_field_tag :move_to, c.position+1 %>
							<%= submit_tag("Add Passage") %>
						<% end %>
					</div>

				</div>

			<% end %>
<!--     -------------------------------------------------------------------------------------------- -->
			<% break %>
		<% end %>

	<% end %>

	<% $i += 1 %>
<% end %>